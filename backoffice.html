<?xml version="1.0" encoding="UTF-8"?>
<div xmlns="http://www.w3.org/1999/xhtml" data-template="templates:surround" data-template-with="templates/page.html" data-template-at="content">
    <div class=" col-md-12"/>
    <div class="row">
        <div class=" col-md-2">
            <div class="panel panel-default">
                <div class="panel-heading">                    
                <!-- improve TOC presentation ? -->
                    <a href="#main">
                        <i class="glyphicon glyphicon-signal"/>Main</a>
                    <br/>
                    <a href="#doc">
                        <i class="glyphicon glyphicon-book"/>Doc</a>
                    <br/>
                    <a href="#vega">
                        <i class="glyphicon glyphicon-upload"/>Climb/Classic</a>
                    <br/>
                    <a href="#vega">
                        <i class="glyphicon glyphicon-upload"/>Vega</a>
                    <br/>
                    <a href="#submits">
                        <i class="glyphicon glyphicon-upload"/>Submits</a>
                    <br/>
                    <a href="#visits">
                        <i class="glyphicon glyphicon-download"/>Visits</a>
                    <br/>
                    <a href="#searches">
                        <i class="glyphicon glyphicon-download"/>Searches</a>
                    <br/>
                    <a href="#downloads">
                        <i class="glyphicon glyphicon-download"/>Downloads</a>
                    <br/>
                    <a href="#comments">
                        <i class="glyphicon glyphicon-comment"/>Comments</a>
                    <br/>
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <div class="panel panel-default" id="main">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-signal"/>&#160;Main Status</h3>
                </div>
                <div class="panel-body">
                    <div class="backoffice:main-status"/>
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <div class="panel panel-default" id="doc">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-book"/>&#160;Documentation</h3>
                </div>
                <div class="panel-body">
                    <form action="modules/backoffice-job.xql" method="post" class="form-inline" role="form">
                        <button type="submit" name="do" value="doc-update" class="btn btn-default">Update doc</button>
                        <div class="form-group">
                            <b>Last update</b>: <span data-template="backoffice:doc-status"/>
                        </div>
                    </form>
                </div>
            </div>
            <div class="panel panel-default" id="cache">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-book"/>&#160;Caches</h3>
                </div>
                <div class="panel-body">
                    <ul>
                    <li>
                            <b>OIDB</b>: <span data-template="backoffice:cache-status"/>
                        </li>
                    <li>
                            <b>ESO (programs)</b>: <span data-template="backoffice:eso-cache-status"/>
                        </li>
                    <li>
                            <b>ADS (bibrecords)</b>: <span data-template="backoffice:ads-cache-status"/>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-7">
            <div class="panel panel-default" id="eso">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-upload"/>&#160;VLTI L0</h3>
                </div>
                <div class="panel-body">
                    <form action="modules/backoffice-job.xql" enctype="multipart/form-data" method="post" class="form-inline" role="form">
                        <input type="file" name="file" placeholder="VOTable from TAP vizier with observation logs"/>
                        <button type="submit" name="do" value="eso-update" class="btn btn-default">Update ESO</button>
                        <div class="form-group">
                            <b>Last update</b>: <span data-template="backoffice:eso-status"/>
                        </div>
                    </form>
                    <ul>
                        <li> Visit <a href="http://tapvizier.u-strasbg.fr/adql/?B/eso">TAP Vizier</a>
                        </li>
                        <li> Select:  Max records : <b>ALL</b>, Output format : <b>VOTABLE</b>
                        </li>
                        <li> Perform following query <br/>
                            <code>SELECT * FROM "B/eso/eso_arc" WHERE  "B/eso/eso_arc".ObsTech='INTERFEROMETRY'</code>
                        </li>
                        <li>Dowload the result on your disk and upload it using this form!</li>
                    </ul>
                </div>
            </div>
            </div>
        <div class="col-md-5">
            <div class="panel panel-default" id="chara">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-upload"/>&#160;Climb/Classic L0</h3>
                </div>
                <div class="panel-body">
                    <form action="modules/backoffice-job.xql" enctype="multipart/form-data" method="post" class="form-inline" role="form">
                        <input type="file" name="file" placeholder="CSV file with Climb/Classic observation logs"/>
                        <button type="submit" name="do" value="chara-update" class="btn btn-default">Upload Climb/Classic CSV record</button>
                        <div class="form-group">
                            <b>Last update</b>: <span data-template="backoffice:chara-status"/>
                        </div>
                    </form>
                </div>
            </div>
            <div class="panel panel-default" id="vega">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-upload"/>&#160;Vega L0 upload</h3>
                </div>
                <div class="panel-body">
                    <form action="modules/backoffice-job.xql" method="post" class="form-inline" role="form">
                        <button type="submit" name="do" value="vega-update" class="btn btn-default">Update vega logs</button>
                        <div class="form-group">
                            <b>Last update</b>: <span data-template="backoffice:vega-status"/>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12" id="submits">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-upload"/>&#160;Submission dashboard</h3>
                </div>
                <div class="panel-body">
                    <div class="backoffice:submission-status"/>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class=" col-md-12" id="visits">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-download"/>&#160;Visit dashboard</h3>
                </div>
                <div class="panel-body">
                    <div class="backoffice:visit-status"/>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class=" col-md-12" id="searches">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-download"/>&#160;Search dashboard</h3>
                </div>
                <div class="panel-body">
                    <div class="backoffice:search-status"/>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class=" col-md-12" id="downloads">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-download"/>&#160;Download dashboard</h3>
                </div>
                <div class="panel-body">
                    <div class="backoffice:download-status"/>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class=" col-md-12" id="comments">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="glyphicon glyphicon-comment"/>&#160;Comments dashboard</h3>
                </div>
                <div class="panel-body">
                    <table class="table table-condensed" data-template="comments:last-comments">
                        <tr>
                            <th>Type</th>
                            <th>When</th>
                            <th>Who</th>
                            <th>Text</th>
                        </tr>
                        <tr data-template="helpers:each" data-template-from="comments" data-template-to="comment">
                            <td>
                                <a class="badge" data-template="comments:get-comment-url" data-template-key="comment" data-template-attribute-name="href">
                                    <span data-template="comments:get-comment-type" data-template-key="comment"/>
                                </a>
                            </td>
                            <td>
                                <span data-template="helpers:model-value" data-template-key="comment.date"/>
                            </td>
                            <td>
                                <span data-template="app:get-obfuscated-email" data-template-key="comment.author"/>
                            </td>
                            <td>
                                <span data-template="app:ellipsize" data-template-key="comment.text" data-template-length="80"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>